{% extends 'lab/base.html' %}
{% block title %}Stock Info{% endblock %}
{% block body_block %}

{% if stock_info %}
  <div class="hero-unit">
    <h1>Stock Info: <a href='/lab/stock/{{stock_info.id}}/'>{{stock_info.seed_id}}</a></h1>
  </div>

  <hr>
  <a href='/lab/seed_inventory/update/{{stock_info.id}}/'><input class="btn btn-info" type="submit" name="submit" value="Update Seed Information"/></a>
  {% if stock_packets %}
  <a href='/lab/seed_inventory/packet_update/{{stock_info.id}}/'><input class="btn btn-info" type="submit" name="submit" value="Update Seed Packets"/></a>
  {% endif %}
  <a href='/lab/log_data/seed_packet/'><input class="btn btn-warning" type="submit" name="submit" value="Add New Seed Packets"/></a>
  <hr>

  <h2>Seed Stock</h2>
  <table id="single_stock_info" class="table table-striped table-bordered" cellspacing="0" width="100%">
    <thead>
      <tr>
        <th>Seed ID</th>
        <th>Seed Name</th>
        <th>Cross Type</th>
        <th>Pedigree</th>
        <th>Status</th>
        <th>Stock Date</th>
        <th>Comments</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a href='/lab/stock/{{stock_info.id}}/'>{{ stock_info.seed_id }}</a></td>
        <td>{{ stock_info.seed_name }}</td>
        <td>{{ stock_info.cross_type }}</td>
        <td>{{ stock_info.pedigree }}</td>
        <td>{{ stock_info.stock_status }}</td>
        <td>{{ stock_info.stock_date }}</td>
        <td>{{ stock_info.comments }}</td>
      </tr>
    </tbody>
  </table>

  {% for t in obs_tracker %}
    {% if t.obs_entity_type == 'stock' %}
      {% include 'lab/tracker_info_table.html' with obs_tracker=obs_tracker %}
    {% endif %}
  {% endfor %}

  {% if stock_info.passport.taxonomy.population != 'No Taxonomy' and stock_info.passport.taxonomy.population != '' %}
  <h2>Taxonomy</h2>
  <table id="single_stock_taxonomy_info" class="table table-striped table-bordered" cellspacing="0" width="100%">
    <thead>
      <tr>
        <th>Genus</th>
        <th>Species</th>
        <th>Population</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>{{ stock_info.passport.taxonomy.genus }}</td>
        <td>{{ stock_info.passport.taxonomy.species }}</td>
        <td>{{ stock_info.passport.taxonomy.population }}</td>
      </tr>
    </tbody>
  </table>
  {% else %}
    <hr>
    <h2><small>No Taxonomy Info</small></h2>
    <hr>
  {% endif %}

  {% if stock_info.passport.collecting.collection_date != 'No Collection' %}
    <h2>Collection Info</h2>
    <table id="single_stock_collecting_info" class="table table-striped table-bordered" cellspacing="0" width="100%">
      <thead>
          <th>Collector</th>
          <th>Collection Date</th>
          <th>Method</th>
          <th>Comments</th>
        </tr>
      </thead>
      <tbody>
        {% for collection in obs_tracker %}
          {% if collection.obs_entity_type == 'stock' %}
          <tr>
            <td><a href='/lab/profile/{{ stock_info.passport.collecting.user.username }}/'>{{ stock_info.passport.collecting.user }}</a></td>
            <td>{{ stock_info.passport.collecting.collection_date }}</td>
            <td>{{ stock_info.passport.collecting.collection_method }}</td>
            <td>{{ stock_info.passport.collecting.comments }}</td>
          </tr>
          {% endif %}
        {% endfor %}
      </tbody>
    </table>
  {% else %}
  <hr>
  <h2><small>No Collection Info</small></h2>
  <hr>
  {% endif %}

  {% if stock_info.passport.people.id != 1 and stock_info.passport.people.id != 2 and stock_info.passport.people.id != 35 %}
  <h2>Source Info</h2>
  <table id="single_stock_collecting_info" class="table table-striped table-bordered" cellspacing="0" width="100%">
    <thead>
      <tr>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Organization</th>
        <th>Phone</th>
        <th>Email</th>
        <th>Comments</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>{{ stock_info.passport.people.first_name }}</td>
        <td>{{ stock_info.passport.people.last_name }}</td>
        <td>{{ stock_info.passport.people.organization }}</td>
        <td>{{ stock_info.passport.people.phone }}</td>
        <td>{{ stock_info.passport.people.email }}</td>
        <td>{{ stock_info.passport.people.comments }}</td>
      </tr>
    </tbody>
  </table>
  {% else %}
    <hr>
    <h2><small>No Source Info</small></h2>
    <hr>
  {% endif %}

  {% if stock_packets %}
    <h2>Seed Packets</h2>
    <table id="single_stock_seed_packets" class="table table-striped table-bordered" cellspacing="0" width="100%">
      <thead>
        <tr>
          <th>Seed ID</th>
          <th>Seed Status</th>
          <th>Weight (g)</th>
          <th>Num Seeds</th>
          <th>Packet Comments</th>
          <th>Building Name</th>
          <th>Location Name</th>
          <th>Room</th>
          <th>Shelf</th>
          <th>Column</th>
          <th>Box</th>
          <th>Location Comments</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for packet in stock_packets %}
        <tr>
          <td><a href='/lab/stock/{{packet.stock.id}}/'>{{ packet.stock.seed_id }}</a></td>
          <td>{{ packet.stock.stock_status }}</td>
          <td>{{ packet.weight }}</td>
          <td>{{ packet.num_seeds }}</td>
          <td>{{ packet.comments }}</td>
          <td>{{ packet.location.building_name }}</td>
          <td>{{ packet.location.location_name }}</td>
          <td>{{ packet.location.room }}</td>
          <td>{{ packet.location.shelf }}</td>
          <td>{{ packet.location.column }}</td>
          <td>{{ packet.location.box_name }}</td>
          <td>{{ packet.location.comments }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <hr>
    <h2><small>No Seed Packets</small></h2>
    <hr>
  {% endif %}

  <hr>
  {% if obs_tracker %}
  <h2>Seed Used For</h2>
  <table class="selected_stocks" class="table table-striped table-bordered" cellspacing="0" width="100%">
    <thead>
      <tr>
        <th>Obs Type</th>
        <th>Obs ID</th>
        <th>Experiment</th>
      </tr>
    </thead>
    <tbody>
      {% for t in obs_tracker %}
      <tr>
        <td>{{ t.obs_entity_type }}</td>
        <td><a href='{{ t.obs_id_url }}'>{{ t.obs_id }}</a></td>
        <td><a href='/lab/experiment/{{t.experiment}}/'>{{ t.experiment }}</a></td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <hr>
  <h2><small>Not Used In Any Data!</small></h2>
  <hr>
  {% endif %}

{% else %}
  <div class="hero-unit">
    <h1>Stock Info: <a href='/lab/'>Not Found!</a></h1>
  </div>
  <br/>
  <hr>
  <h2>No Stock Info Found!</h2>
  <a href='/lab/log_data/seed_inventory/'><input class="btn btn-warning" type="submit" name="submit" value="Add New Seed Information"/></a>
  <hr>
{% endif %}

{% endblock %}
